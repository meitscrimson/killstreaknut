<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c3{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c2{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c3 doc-content"><p class="c1"><span class="c0">&lt;!DOCTYPE html&gt;</span></p><p class="c1"><span class="c0">&lt;html lang=&quot;en&quot;&gt;</span></p><p class="c1"><span class="c0">&lt;head&gt;</span></p><p class="c1"><span class="c0">&lt;meta charset=&quot;UTF-8&quot;&gt;</span></p><p class="c1"><span class="c0">&lt;title&gt;Slap Battles Killstreak &mdash; FINAL FULL BUILD&lt;/title&gt;</span></p><p class="c1"><span class="c0">&lt;style&gt;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; body {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; margin: 0;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; overflow: hidden;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; background: #87CEEB;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; font-family: Arial, sans-serif;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; #gameCanvas {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; display: block;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; background: linear-gradient(#87CEEB 60%, #3ca33c 60%);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; margin: 0 auto;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; #ui {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; position: absolute;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; top: 10px;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; left: 10px;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; font-size: 26px;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; color: white;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; text-shadow: 0 0 5px black;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; user-select: none;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; #screenFX {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; position: fixed;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; width: 100%;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; height: 100%;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; pointer-events: none;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; top: 0;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; left: 0;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; background: transparent;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; mix-blend-mode: multiply;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; #gameOver {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; position: absolute;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; top: 50%;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; left: 50%;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; transform: translate(-50%, -50%);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; font-size: 40px;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; color: red;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; display: none;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; text-align: center;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1"><span class="c0">&lt;/style&gt;</span></p><p class="c1"><span class="c0">&lt;/head&gt;</span></p><p class="c1"><span class="c0">&lt;body&gt;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&lt;canvas id=&quot;gameCanvas&quot; width=&quot;900&quot; height=&quot;600&quot;&gt;&lt;/canvas&gt;</span></p><p class="c1"><span class="c0">&lt;div id=&quot;ui&quot;&gt;Killstreak: 0&lt;/div&gt;</span></p><p class="c1"><span class="c0">&lt;div id=&quot;screenFX&quot;&gt;&lt;/div&gt;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&lt;div id=&quot;gameOver&quot;&gt;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; GAME OVER&lt;br&gt;&lt;br&gt;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &lt;button onclick=&quot;location.reload()&quot;&gt;Play Again&lt;/button&gt;</span></p><p class="c1"><span class="c0">&lt;/div&gt;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&lt;script&gt;</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">// GLOBALS</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">const canvas = document.getElementById(&quot;gameCanvas&quot;);</span></p><p class="c1"><span class="c0">const ctx = canvas.getContext(&quot;2d&quot;);</span></p><p class="c1"><span class="c0">const fx = document.getElementById(&quot;screenFX&quot;);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">let keys = {};</span></p><p class="c1"><span class="c0">let killstreak = 0;</span></p><p class="c1"><span class="c0">let frame = 0;</span></p><p class="c1"><span class="c0">let gameOver = false;</span></p><p class="c1"><span class="c0">let invincible = false;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// Phase flags</span></p><p class="c1"><span class="c0">let phase5 = false, phase10 = false, phase25 = false, phase25Done = false;</span></p><p class="c1"><span class="c0">let phase50 = false, phase75 = false, phase100 = false;</span></p><p class="c1"><span class="c0">let phase150 = false, phase175 = false;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// Glove swing</span></p><p class="c1"><span class="c0">let swingTimer = 0;</span></p><p class="c1"><span class="c0">let swinging = false;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// Orb</span></p><p class="c1"><span class="c0">let orbActive = false;</span></p><p class="c1"><span class="c0">let orbX = 0, orbY = 0;</span></p><p class="c1"><span class="c0">let orbSize = 40;</span></p><p class="c1"><span class="c0">let orbColor = &quot;purple&quot;;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">// MUSIC SYSTEM</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">let currentMusic = null;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">function playMusic(file) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (currentMusic) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; currentMusic.pause();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; currentMusic.currentTime = 0;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; currentMusic = new Audio(file);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; currentMusic.loop = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; currentMusic.volume = 0.75;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; currentMusic.play();</span></p><p class="c1"><span class="c0">}</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">// PLAYER</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">const player = {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; x: canvas.width / 2,</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; y: canvas.height / 2,</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; size: 25,</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; speed: 3,</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; baseSpeed: 3,</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; color: &quot;white&quot;,</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; trail: [],</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; trailColor: &quot;white&quot;,</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; facingX: 1,</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; facingY: 0</span></p><p class="c1"><span class="c0">};</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">// ENEMIES</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">let enemies = [];</span></p><p class="c1"><span class="c0">let spawnInterval = 65;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">function spawnEnemy() {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; const side = Math.random() * 4;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; let x, y;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (side &lt; 1) { x = 0; y = Math.random() * canvas.height; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; else if (side &lt; 2) { x = canvas.width; y = Math.random() * canvas.height; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; else if (side &lt; 3) { x = Math.random() * canvas.width; y = 0; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; else { x = Math.random() * canvas.width; y = canvas.height; }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; let e = { x, y, size: 28, speed: 1.35, hp: 1 };</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (killstreak &gt;= 5) { e.speed *= 1.25; e.hp = 3; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (killstreak &gt;= 10) { e.speed *= 1.25; e.hp = 4; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (killstreak &gt;= 25) { e.speed *= 1.35; e.hp = 5; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (killstreak &gt;= 150) { e.speed *= 1.45; e.hp = 6; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (killstreak &gt;= 175) { e.speed *= 1.6; e.hp = 7; }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; enemies.push(e);</span></p><p class="c1"><span class="c0">}</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">// TRAIL</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">function updateTrail() {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; player.trail.push({</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; x: player.x,</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; y: player.y,</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; color: player.trailColor,</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; life: 25</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; });</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (player.trail.length &gt; 60) player.trail.shift();</span></p><p class="c1"><span class="c0">}</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">// MOVEMENT</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">function playerMovement() {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (keys[&quot;KeyW&quot;]) { player.y -= player.speed; player.facingY = -1; player.facingX = 0; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (keys[&quot;KeyS&quot;]) { player.y += player.speed; player.facingY = 1; player.facingX = 0; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (keys[&quot;KeyA&quot;]) { player.x -= player.speed; player.facingX = -1; player.facingY = 0; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (keys[&quot;KeyD&quot;]) { player.x += player.speed; player.facingX = 1; player.facingY = 0; }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; player.x = Math.max(player.size, Math.min(canvas.width - player.size, player.x));</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; player.y = Math.max(player.size, Math.min(canvas.height - player.size, player.y));</span></p><p class="c1"><span class="c0">}</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">// SLAP + SWING</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">function slap() {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; swinging = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; swingTimer = 7;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; const hitWidth = 90;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; const hitHeight = 60;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; const hx = player.x + player.facingX * 50;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; const hy = player.y + player.facingY * 50;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; enemies.forEach(e =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; if (Math.abs(e.x - hx) &lt; hitWidth / 2 &amp;&amp;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Math.abs(e.y - hy) &lt; hitHeight / 2) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.hp--;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; });</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; enemies = enemies.filter(e =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; if (e.hp &lt;= 0) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; killstreak++;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById(&quot;ui&quot;).innerText = &quot;Killstreak: &quot; + killstreak;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; return true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; });</span></p><p class="c1"><span class="c0">}</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">function drawGloveSwing() {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (!swinging) return;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; swingTimer--;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (swingTimer &lt;= 0) swinging = false;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; const gx = player.x + player.facingX * (player.size + 45);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; const gy = player.y + player.facingY * (player.size + 45);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.save();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.globalAlpha = 0.75;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.fillStyle = player.color;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.beginPath();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.arc(gx, gy, 18, 0, Math.PI * 2);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.fill();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.restore();</span></p><p class="c1"><span class="c0">}</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">// ORB ABILITY</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">canvas.addEventListener(&quot;mousemove&quot;, e =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; const r = canvas.getBoundingClientRect();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; orbX = e.clientX - r.left;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; orbY = e.clientY - r.top;</span></p><p class="c1"><span class="c0">});</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">function drawOrb() {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (!orbActive) return;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.globalAlpha = 0.7;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.fillStyle = orbColor;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.beginPath();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.arc(orbX, orbY, orbSize, 0, Math.PI * 2);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.fill();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.globalAlpha = 1;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; enemies.forEach(e =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; let d = Math.hypot(e.x - orbX, e.y - orbY);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; if (d &lt; orbSize + e.size) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let ang = Math.atan2(e.y - orbY, e.x - orbX);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.x += Math.cos(ang) * 20;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.y += Math.sin(ang) * 20;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; });</span></p><p class="c1"><span class="c0">}</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">// ENEMY MOVEMENT</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">function moveEnemies() {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; enemies.forEach(e =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; const dx = player.x - e.x;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; const dy = player.y - e.y;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; const dist = Math.hypot(dx, dy);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; e.x += dx / dist * e.speed;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; e.y += dy / dist * e.speed;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; if (!invincible &amp;&amp; dist &lt; player.size + e.size / 2) endGame();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; });</span></p><p class="c1"><span class="c0">}</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">// CHECK PHASES</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">function checkPhases() {</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; // -------- PHASE 5 --------</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (killstreak &gt;= 5 &amp;&amp; !phase5) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; phase5 = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; playMusic(&quot;music/phase5.mp3&quot;);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.color = &quot;red&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.trailColor = &quot;rgba(255,0,0,0.75)&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.speed = player.baseSpeed * 1.25;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; // -------- PHASE 10 --------</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (killstreak &gt;= 10 &amp;&amp; !phase10) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; phase10 = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; playMusic(&quot;music/phase10.mp3&quot;);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.color = &quot;darkred&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.trailColor = &quot;rgba(255,40,40,0.9)&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.speed = player.baseSpeed * 2;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // Screen pulsating red</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; setInterval(() =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!phase25) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let a = 0.25 + Math.sin(Date.now() / 200) * 0.15;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fx.style.background = `rgba(255,0,0,${a})`;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; }, 60);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; // -------- PHASE 25 --------</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (killstreak &gt;= 25 &amp;&amp; !phase25) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; phase25 = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; playMusic(&quot;music/phase25.mp3&quot;);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.speed = player.baseSpeed * 0.5;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; let a = 0;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; let fadeBlue = setInterval(() =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a += 0.01;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fx.style.background = `rgba(0,0,255,${a})`;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (a &gt;= 0.5) clearInterval(fadeBlue);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; }, 50);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; setTimeout(() =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; phase25Done = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; player.color = &quot;cyan&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; player.trailColor = &quot;rgba(0,255,255,0.85)&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; player.speed = player.baseSpeed * 3.25;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; }, 12000);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; // -------- PHASE 50 --------</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (killstreak &gt;= 50 &amp;&amp; !phase50) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; phase50 = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; playMusic(&quot;music/phase50.mp3&quot;);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; enemies.forEach(e =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let ang = Math.atan2(e.y - player.y, e.x - player.x);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.x += Math.cos(ang) * 80;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.y += Math.sin(ang) * 80;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; });</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // Screen &rarr; red (61%)</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; let a = 0;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; let tint = setInterval(() =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; a += 0.01;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fx.style.background = `rgba(255,0,0,${a})`;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (a &gt;= 0.61) clearInterval(tint);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; }, 40);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.color = &quot;orange&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.trailColor = &quot;rgba(255,140,0,0.95)&quot;;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; let sp = player.speed;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; let ramp = setInterval(() =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sp += 0.1;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; player.speed = sp;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (sp &gt;= player.baseSpeed * 6) clearInterval(ramp);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; }, 50);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; // -------- PHASE 75 --------</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (killstreak &gt;= 75 &amp;&amp; !phase75) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; phase75 = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; playMusic(&quot;music/phase75.mp3&quot;);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; fx.style.background = &quot;transparent&quot;;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.color = &quot;purple&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.trailColor = &quot;rgba(190,0,255,0.9)&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.speed = player.baseSpeed;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; orbActive = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; orbColor = &quot;purple&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; orbSize = player.size * 1.25;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; let lastKill = killstreak;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; setInterval(() =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (killstreak &gt; lastKill &amp;&amp; killstreak &lt; 85) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; player.speed += player.baseSpeed * 0.005;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lastKill = killstreak;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; }, 250);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; // -------- PHASE 100 --------</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (killstreak &gt;= 100 &amp;&amp; !phase100) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; phase100 = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; playMusic(&quot;music/phase100.mp3&quot;);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; orbSize = player.size * 3;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; orbColor = &quot;yellow&quot;;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.color = &quot;yellow&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.trailColor = &quot;rgba(255,255,0,1)&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.speed = player.baseSpeed * 6.5;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; fx.style.background = &quot;yellow&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; invincible = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; setTimeout(() =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invincible = false;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fx.style.background = &quot;transparent&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; }, 6000);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; // -------- PHASE 150 --------</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (killstreak &gt;= 150 &amp;&amp; !phase150) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; phase150 = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; playMusic(&quot;music/phase150.mp3&quot;);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; fx.style.background = &quot;rgba(0,0,255,0.50)&quot;;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.speed = player.baseSpeed * 6.75;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.color = &quot;darkblue&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.trailColor = &quot;rgba(0,0,180,0.85)&quot;;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; orbActive = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; orbColor = &quot;darkblue&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; orbSize = player.size * 4;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; // -------- PHASE 175 --------</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (killstreak &gt;= 175 &amp;&amp; !phase175) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; phase175 = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; playMusic(&quot;music/phase175.mp3&quot;);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // Screen transition blue &rarr; orange</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; let t = 0;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; let blend = setInterval(() =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; t += 0.01;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (t &gt;= 1) { t = 1; clearInterval(blend); }</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let r = Math.floor(0 + (255 * t));</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let g = Math.floor(0 + (120 * t));</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let b = Math.floor(255 - (255 * t));</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fx.style.background = `rgba(${r}, ${g}, ${b}, 0.55)`;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; }, 40);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // Explosion knockback</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; enemies.forEach(e =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let ang = Math.atan2(e.y - player.y, e.x - player.x);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.x += Math.cos(ang) * 130;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.y += Math.sin(ang) * 130;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; });</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // Speed 7x</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.speed = player.baseSpeed * 7;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; // ORANGE THEME (PLAYER + ORB)</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.color = &quot;orange&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; player.trailColor = &quot;rgba(255,140,0,0.95)&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; orbColor = &quot;orange&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; orbSize = player.size * 5;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1"><span class="c0">}</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">// DRAW</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">function draw() {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.clearRect(0, 0, canvas.width, canvas.height);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; player.trail.forEach(t =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; ctx.globalAlpha = t.life / 25;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; ctx.fillStyle = t.color;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; ctx.beginPath();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; ctx.arc(t.x, t.y, 10, 0, Math.PI * 2);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; ctx.fill();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; t.life--;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; });</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.globalAlpha = 1;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.fillStyle = player.color;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.beginPath();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.arc(player.x, player.y, player.size, 0, Math.PI * 2);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.fill();</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; drawGloveSwing();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; drawOrb();</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; ctx.fillStyle = &quot;red&quot;;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; enemies.forEach(e =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; ctx.beginPath();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; ctx.arc(e.x, e.y, e.size, 0, Math.PI * 2);</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; ctx.fill();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; });</span></p><p class="c1"><span class="c0">}</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">// GAME LOOP</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">function update() {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (gameOver) return;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; frame++;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (frame % spawnInterval === 0) spawnEnemy();</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; checkPhases();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; playerMovement();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; moveEnemies();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; updateTrail();</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; draw();</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; requestAnimationFrame(update);</span></p><p class="c1"><span class="c0">}</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">// END GAME</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">function endGame() {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; gameOver = true;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; document.getElementById(&quot;gameOver&quot;).style.display = &quot;block&quot;;</span></p><p class="c1"><span class="c0">}</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">// INPUT</span></p><p class="c1"><span class="c0">// =========================================================</span></p><p class="c1"><span class="c0">window.addEventListener(&quot;keydown&quot;, e =&gt; {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; keys[e.code] = true;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">&nbsp; &nbsp; // -------- E adds a kill --------</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; if (e.code === &quot;KeyE&quot;) {</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; killstreak++;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; &nbsp; &nbsp; document.getElementById(&quot;ui&quot;).innerText = &quot;Killstreak: &quot; + killstreak;</span></p><p class="c1"><span class="c0">&nbsp; &nbsp; }</span></p><p class="c1"><span class="c0">});</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">window.addEventListener(&quot;keyup&quot;, e =&gt; keys[e.code] = false);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">canvas.addEventListener(&quot;click&quot;, slap);</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">update();</span></p><p class="c1"><span class="c0">&lt;/script&gt;</span></p><p class="c1"><span class="c0">&lt;/body&gt;</span></p><p class="c1"><span class="c0">&lt;/html&gt;</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1 c2"><span class="c0"></span></p></body></html>